<!DOCTYPE html>
<html>
<head>
    <title>Place Details</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }
        #details-container {
            width: 80%;
            padding: 20px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: left;
        }
        #map, #street-view {
            height: 40%;
            width: 80%;
            margin: 10px 0;
        }
    </style>
    <script>
        function initMap() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name');
            const address = urlParams.get('address');
            const rating = urlParams.get('rating');
            const userRatingsTotal = urlParams.get('userRatingsTotal');
            const openNow = urlParams.get('openNow') === "Yes";
            const distance = urlParams.get('distance');

            document.getElementById('place-name').innerText = name;
            document.getElementById('place-address').innerText = `Address: ${address}`;
            document.getElementById('place-rating').innerText = `Rating: ${rating}`;
            document.getElementById('place-user-ratings-total').innerText = `User Ratings: ${userRatingsTotal}`;
            document.getElementById('place-open-now').innerText = `Open Now: ${openNow ? "Yes" : "No"}`;
            document.getElementById('place-distance').innerText = `Distance: ${distance} meters`;

            const geocoder = new google.maps.Geocoder();
            geocoder.geocode({ address: address }, (results, status) => {
                if (status === 'OK') {
                    const location = results[0].geometry.location;
                    const map = new google.maps.Map(document.getElementById('map'), {
                        center: location,
                        zoom: 15
                    });
                    new google.maps.Marker({
                        position: location,
                        map: map,
                        title: name
                    });

                    const panorama = new google.maps.StreetViewPanorama(
                        document.getElementById('street-view'), {
                            position: location,
                            pov: {
                                heading: 34,
                                pitch: 10
                            }
                        });
                    map.setStreetView(panorama);
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });
        }
    </script>
</head>
<body onload="initMap()">
    <div id="details-container">
        <h1 id="place-name"></h1>
        <p id="place-address"></p>
        <p id="place-rating"></p>
        <p id="place-user-ratings-total"></p>
        <p id="place-open-now"></p>
        <p id="place-distance"></p>
    </div>
    <div id="map"></div>
    <div id="street-view"></div>
    <script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap" async defer></script>
</body>
</html>
